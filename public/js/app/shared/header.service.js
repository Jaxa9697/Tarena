"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Created by Jahongir on 13-Apr-17.
 */
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
require("rxjs/add/operator/toPromise");
require("rxjs/Rx");
var components_model_1 = require("./components.model");
var HeaderService = (function () {
    function HeaderService(http) {
        this.http = http;
    }
    HeaderService.prototype.getAtcContent = function () {
        return this.http.get('/getAtcContent')
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.getWOContent = function (query) {
        return this.http.get(query)
            .map(function (data) {
            return data.json();
        }).map(function (data) {
            var rows = [];
            if (data) {
                data.forEach(function (el, i) {
                    var row = new components_model_1.Wifi((i + 1), el.ID, el.type, el.name_cl, el.itMan, el.address, el.n_passport, el.telephone, el.phone, el.ipAddress, el.vlan, el.id_client);
                    rows.push(row);
                });
            }
            return rows;
        });
    };
    HeaderService.prototype.getVlanContent = function () {
        return this.http.get('/getVlanContent')
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.getPrivilegeContent = function () {
        return this.http.get('/getPrivilegeContent')
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.getUserPrivileges = function (user, number) {
        var pAtc = new components_model_1.CRUD(user.p_atc).getcrud();
        var pVlan = new components_model_1.CRUD(user.p_vlan).getcrud();
        var pReport = new components_model_1.CRUD(user.p_report).getcrud();
        var pWifi = new components_model_1.CRUD(user.p_wifi).getcrud();
        var pOptics = new components_model_1.CRUD(user.p_optics).getcrud();
        return new components_model_1.Privilege(user.ID, number, user.username, user.status, pAtc, pVlan, pReport, pWifi, pOptics, false);
    };
    HeaderService.prototype.getReportContent = function () {
        return this.http.get('/getReportContent')
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.getProblemContent = function () {
        var _this = this;
        return this.http.get('/getProblemContent')
            .map(function (data) {
            return data.json();
        }).map(function (data) {
            var problems = [];
            data.forEach(function (el, i) {
                var createDate = _this.getDate(new Date(el.createDate));
                var solveDate = _this.getDate(new Date(el.solveDate));
                if (!el.solveDate) {
                    solveDate = '';
                }
                var problem = new components_model_1.Problem(el.ID, (i + 1), createDate, solveDate, el.username, el.problem, !!el.solveDate, false);
                problems.push(problem);
            });
            return problems;
        });
    };
    HeaderService.prototype.getSignContent = function () {
        return this.http.get('/getSignContent')
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.getVlanList = function () {
        return this.http.get('/getVlanList')
            .map(function (data) {
            return data.json();
        }).map(function (data) {
            return {
                vlans: Object.values(data.vlan),
                atcs: Object.values(data.atc)
            };
        });
    };
    HeaderService.prototype.getAtcContentById = function (id) {
        return this.http.get('/getAtcContentById?id=' + id.toString())
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.getClientsByVlan = function (vlan) {
        return this.http.get('/getClientsByVlan?id=' + vlan.id.toString())
            .map(function (data) {
            return data.json();
        }).map(function (data) {
            var quantity = 255 - Number(vlan.subnetMask.split(".")[3]);
            var gatewayArray = vlan.gateway.split(".");
            var idNode = Number(gatewayArray[3]);
            gatewayArray.splice(-1, 1);
            var networkNode = gatewayArray.join().replace(/,/g, ".");
            var isData;
            var client;
            var clients = [];
            for (var i = 1; i <= quantity; i++) {
                var ip = networkNode + "." + (idNode + i);
                for (var j = 0; j < data.length; j++) {
                    if (data[j].ipAddress == ip) {
                        isData = true;
                        client = new components_model_1.VlansClients(i, data[j].name_cl, data[j].telephone, data[j].ipAddress);
                        break;
                    }
                    else {
                        isData = false;
                    }
                }
                if (!isData) {
                    client = new components_model_1.VlansClients(i, '', '', ip);
                }
                clients.push(client);
            }
            return clients;
        });
    };
    HeaderService.prototype.addNewVlan = function (obj) {
        var body = JSON.stringify(obj);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.post('/addNewVlan', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.addNewAtc = function (obj) {
        var body = JSON.stringify(obj);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.post('/addNewAtc', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.addNewWO = function (obj) {
        var body = JSON.stringify(obj);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.post('/addNewWO', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.deleteVlan = function (id) {
        return this.http.delete('/deleteVlan?id=' + id)
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.deleteAtc = function (id) {
        return this.http.delete('/deleteAtc?id=' + id)
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.deleteWO = function (id) {
        return this.http.delete('/deleteWO?id=' + id)
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.updateVlan = function (obj) {
        var body = JSON.stringify(obj);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.put('/updateVlan', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.updateAtc = function (obj) {
        var body = JSON.stringify(obj);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.put('/updateAtc', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.updateWO = function (obj) {
        var body = JSON.stringify(obj);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.put('/updateWO', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.saveReport = function (data) {
        var body = JSON.stringify(data);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.post('/saveReport', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.saveNewProblem = function (data) {
        var body = JSON.stringify(data);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.post('/saveNewProblem', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.filterReportRows = function (data) {
        var body = JSON.stringify(data);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.post('/filterReportRows', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.saveUserPrivileges = function (user) {
        var body = JSON.stringify(user);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.put('/saveUserPrivileges', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.solvingProblem = function (data) {
        var body = JSON.stringify(data);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.put('/saveSolvedProblem', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.searchData = function (query) {
        return this.http.get('/searchData?query=' + query)
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.getResultSearch = function (id) {
        return this.http.get('/getResultSearch?id=' + id.toString())
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.changePassword = function (password) {
        var body = JSON.stringify(password);
        var headers = new http_1.Headers({ 'Content-Type': 'application/json;charset=utf-8' });
        return this.http.put('/changePassword', body, { headers: headers })
            .map(function (data) {
            return data.json();
        });
    };
    HeaderService.prototype.getDate = function (date) {
        var day = date.getDate(), month = date.getMonth() + 1, year = date.getFullYear(), hour = date.getHours(), minute = date.getMinutes();
        // second = date.getSeconds();
        if (month < 10) {
            month = '0' + month;
        }
        if (day < 10) {
            day = '0' + day;
        }
        if (hour < 10) {
            hour = '0' + hour;
        }
        if (minute < 10) {
            minute = '0' + minute;
        }
        // if (second < 10){ second = '0' + second; }
        return year + "-" + month + "-" + day + " " + hour + ":" + minute;
    };
    return HeaderService;
}());
HeaderService = __decorate([
    core_1.Injectable(),
    __metadata("design:paramtypes", [http_1.Http])
], HeaderService);
exports.HeaderService = HeaderService;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL1RhcmVuYTIvYXNzZXRzL2FwcC9zaGFyZWQvaGVhZGVyLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7R0FFRztBQUNILHNDQUEyQztBQUMzQyxzQ0FBeUQ7QUFFekQsdUNBQXFDO0FBQ3JDLG1CQUFpQjtBQUNqQix1REFHNEI7QUFHNUIsSUFBYSxhQUFhO0lBQ3hCLHVCQUFxQixJQUFVO1FBQVYsU0FBSSxHQUFKLElBQUksQ0FBTTtJQUM3QixDQUFDO0lBRUgscUNBQWEsR0FBYjtRQUNFLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQzthQUNuQyxHQUFHLENBQUMsVUFBQyxJQUFjO1lBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDckIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQsb0NBQVksR0FBWixVQUFhLEtBQUs7UUFDaEIsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQzthQUN4QixHQUFHLENBQUMsVUFBQyxJQUFjO1lBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDckIsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQUMsSUFBSTtZQUNWLElBQUksSUFBSSxHQUFHLEVBQUUsQ0FBQztZQUNkLEVBQUUsQ0FBQSxDQUFDLElBQUksQ0FBQyxDQUFBLENBQUM7Z0JBQ1AsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFDLEVBQUUsRUFBQyxDQUFDO29CQUNoQixJQUFJLEdBQUcsR0FBRyxJQUFJLHVCQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsT0FBTyxF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O1FBRWhDLEVBQUUsQ0FBQyxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQUMsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLLENBQUM7UUFBQyxDQUFDO1FBQ3hDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBRyxDQUFDO1lBQUMsR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLENBQUM7UUFBQyxDQUFDO1FBQ3BDLEVBQUUsQ0FBQyxDQUFDLElBQUksR0FBRyxFQUFFLENBQUMsQ0FBRSxDQUFDO1lBQUMsSUFBSSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUM7UUFBQyxDQUFDO1FBQ3RDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUMsQ0FBQSxDQUFDO1lBQUMsTUFBTSxHQUFHLEdBQUcsR0FBRyxNQUFNLENBQUM7UUFBQyxDQUFDO1FBQzFDLDZDQUE2QztRQUU3QyxNQUFNLENBQUMsSUFBSSxHQUFHLEdBQUcsR0FBRyxLQUFLLEdBQUcsR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLEdBQUcsSUFBSSxHQUFHLEdBQUcsR0FBRyxNQUFNLENBQUM7SUFDcEUsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FuVUEsQUFtVUMsSUFBQTtBQW5VWSxhQUFhO0lBRHpCLGlCQUFVLEVBQUU7cUNBRWdCLFdBQUk7R0FEcEIsYUFBYSxDQW1VekI7QUFuVVksc0NBQWEiLCJmaWxlIjoic2hhcmVkL2hlYWRlci5zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSmFob25naXIgb24gMTMtQXByLTE3LlxyXG4gKi9cclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBIdHRwLCBSZXNwb25zZSwgSGVhZGVycyB9IGZyb20gIFwiQGFuZ3VsYXIvaHR0cFwiO1xyXG5cclxuaW1wb3J0ICdyeGpzL2FkZC9vcGVyYXRvci90b1Byb21pc2UnO1xyXG5pbXBvcnQgJ3J4anMvUngnO1xyXG5pbXBvcnQge1xyXG4gIEF0YywgQ1JVRCwgUHJvYmxlbSwgVmxhbiwgVmxhbnNDbGllbnRzLCBXaWZpLCBQcml2aWxlZ2UsIENoYW5nZVBhc3N3b3JkLCBTaWduLFxyXG4gIEZpbHRlclxyXG59IGZyb20gXCIuL2NvbXBvbmVudHMubW9kZWxcIjtcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIEhlYWRlclNlcnZpY2Uge1xyXG4gIGNvbnN0cnVjdG9yIChwcml2YXRlIGh0dHA6IEh0dHBcclxuICApe31cclxuXHJcbiAgZ2V0QXRjQ29udGVudCgpe1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQoJy9nZXRBdGNDb250ZW50JylcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0V09Db250ZW50KHF1ZXJ5KXtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHF1ZXJ5KVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSkubWFwKChkYXRhKT0+e1xyXG4gICAgICAgIGxldCByb3dzID0gW107XHJcbiAgICAgICAgaWYoZGF0YSl7XHJcbiAgICAgICAgICBkYXRhLmZvckVhY2goKGVsLGkpPT57XHJcbiAgICAgICAgICAgIGxldCByb3cgPSBuZXcgV2lmaSgoaSsxKSwgZWwuSUQsIGVsLnR5cGUsIGVsLm5hbWVfY2wsIGVsLml0TWFuLCBlbC5hZGRyZXNzLCBlbC5uX3Bhc3Nwb3J0LFxyXG4gICAgICAgICAgICAgIGVsLnRlbGVwaG9uZSwgZWwucGhvbmUsIGVsLmlwQWRkcmVzcywgZWwudmxhbiwgZWwuaWRfY2xpZW50KTtcclxuICAgICAgICAgICByb3dzLnB1c2gocm93KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJvd3M7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmxhbkNvbnRlbnQoKXtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KCcvZ2V0VmxhbkNvbnRlbnQnKVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRQcml2aWxlZ2VDb250ZW50KCl7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldCgnL2dldFByaXZpbGVnZUNvbnRlbnQnKVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VyUHJpdmlsZWdlcyh1c2VyLCBudW1iZXIpe1xyXG4gICAgbGV0IHBBdGMgICAgPSBuZXcgQ1JVRCh1c2VyLnBfYXRjKS5nZXRjcnVkKCk7XHJcbiAgICBsZXQgcFZsYW4gICA9IG5ldyBDUlVEKHVzZXIucF92bGFuKS5nZXRjcnVkKCk7XHJcbiAgICBsZXQgcFJlcG9ydCA9IG5ldyBDUlVEKHVzZXIucF9yZXBvcnQpLmdldGNydWQoKTtcclxuICAgIGxldCBwV2lmaSAgID0gbmV3IENSVUQodXNlci5wX3dpZmkpLmdldGNydWQoKTtcclxuICAgIGxldCBwT3B0aWNzID0gbmV3IENSVUQodXNlci5wX29wdGljcykuZ2V0Y3J1ZCgpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJpdmlsZWdlKHVzZXIuSUQsIG51bWJlciwgdXNlci51c2VybmFtZSwgdXNlci5zdGF0dXMsIHBBdGMsXHJcbiAgICAgIHBWbGFuLCBwUmVwb3J0LCBwV2lmaSwgcE9wdGljcywgZmFsc2UpO1xyXG5cclxuICB9XHJcblxyXG4gIGdldFJlcG9ydENvbnRlbnQoKXtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KCcvZ2V0UmVwb3J0Q29udGVudCcpXHJcbiAgICAgIC5tYXAoKGRhdGE6IFJlc3BvbnNlICk9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuanNvbigpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFByb2JsZW1Db250ZW50KCl7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldCgnL2dldFByb2JsZW1Db250ZW50JylcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pLm1hcCgoZGF0YSk9PntcclxuICAgICAgICBsZXQgcHJvYmxlbXM6IFByb2JsZW1bXSA9IFtdO1xyXG5cclxuICAgICAgICBkYXRhLmZvckVhY2goKGVsLCBpKT0+e1xyXG4gICAgICAgICAgbGV0IGNyZWF0ZURhdGUgPSB0aGlzLmdldERhdGUobmV3IERhdGUoZWwuY3JlYXRlRGF0ZSkpO1xyXG4gICAgICAgICAgbGV0IHNvbHZlRGF0ZSA9IHRoaXMuZ2V0RGF0ZShuZXcgRGF0ZShlbC5zb2x2ZURhdGUpKTtcclxuXHJcbiAgICAgICAgICBpZighZWwuc29sdmVEYXRlKXsgc29sdmVEYXRlID0gJyc7IH1cclxuXHJcbiAgICAgICAgICBsZXQgcHJvYmxlbSA9IG5ldyBQcm9ibGVtKGVsLklELCAoaSsxKSwgY3JlYXRlRGF0ZSxcclxuICAgICAgICAgICAgc29sdmVEYXRlLCBlbC51c2VybmFtZSwgZWwucHJvYmxlbSwgISFlbC5zb2x2ZURhdGUsIGZhbHNlICk7XHJcblxyXG4gICAgICAgICAgcHJvYmxlbXMucHVzaChwcm9ibGVtKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHByb2JsZW1zO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFNpZ25Db250ZW50KCl7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldCgnL2dldFNpZ25Db250ZW50JylcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0Vmxhbkxpc3QoKXtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KCcvZ2V0Vmxhbkxpc3QnKVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSkubWFwKChkYXRhKT0+e1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICB2bGFuczogKDxhbnk+T2JqZWN0KS52YWx1ZXMoZGF0YS52bGFuKSxcclxuICAgICAgICAgIGF0Y3M6ICg8YW55Pk9iamVjdCkudmFsdWVzKGRhdGEuYXRjKVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRBdGNDb250ZW50QnlJZChpZDogbnVtYmVyKXtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KCcvZ2V0QXRjQ29udGVudEJ5SWQ/aWQ9JyArIGlkLnRvU3RyaW5nKCkpXHJcbiAgICAgIC5tYXAoKGRhdGE6IFJlc3BvbnNlICk9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuanNvbigpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldENsaWVudHNCeVZsYW4odmxhbjogVmxhbil7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldCgnL2dldENsaWVudHNCeVZsYW4/aWQ9JyArIHZsYW4uaWQudG9TdHJpbmcoKSlcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pLm1hcCgoZGF0YSk9PntcclxuXHJcbiAgICAgICAgICBsZXQgcXVhbnRpdHkgPSAyNTUgLSBOdW1iZXIodmxhbi5zdWJuZXRNYXNrLnNwbGl0KFwiLlwiKVszXSk7XHJcbiAgICAgICAgICBsZXQgZ2F0ZXdheUFycmF5ID0gdmxhbi5nYXRld2F5LnNwbGl0KFwiLlwiKTtcclxuXHJcbiAgICAgICAgICBsZXQgaWROb2RlID0gTnVtYmVyKGdhdGV3YXlBcnJheVszXSk7XHJcbiAgICAgICAgICBnYXRld2F5QXJyYXkuc3BsaWNlKC0xLDEpO1xyXG4gICAgICAgICAgbGV0IG5ldHdvcmtOb2RlID0gZ2F0ZXdheUFycmF5LmpvaW4oKS5yZXBsYWNlKC8sL2csIFwiLlwiKTtcclxuXHJcbiAgICAgICAgICBsZXQgaXNEYXRhOiBib29sZWFuO1xyXG4gICAgICAgICAgbGV0IGNsaWVudDogVmxhbnNDbGllbnRzO1xyXG4gICAgICAgICAgbGV0IGNsaWVudHM6IFZsYW5zQ2xpZW50c1tdID0gW107XHJcblxyXG4gICAgICAgICAgZm9yIChsZXQgaT0xOyBpIDw9IHF1YW50aXR5OyBpKyspe1xyXG4gICAgICAgICAgICBsZXQgaXAgPSBuZXR3b3JrTm9kZSArIFwiLlwiICsgKGlkTm9kZSArIGkpO1xyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgaj0wOyBqIDwgZGF0YS5sZW5ndGg7IGorKyl7XHJcbiAgICAgICAgICAgICAgaWYgKGRhdGFbal0uaXBBZGRyZXNzID09IGlwKXtcclxuICAgICAgICAgICAgICAgIGlzRGF0YSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjbGllbnQgPSBuZXcgVmxhbnNDbGllbnRzKGksIGRhdGFbal0ubmFtZV9jbCwgZGF0YVtqXS50ZWxlcGhvbmUsIGRhdGFbal0uaXBBZGRyZXNzKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgICAgIGlzRGF0YSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoIWlzRGF0YSl7XHJcbiAgICAgICAgICAgICAgY2xpZW50ID0gbmV3IFZsYW5zQ2xpZW50cyhpLCAnJywgJycsIGlwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjbGllbnRzLnB1c2goY2xpZW50KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICByZXR1cm4gY2xpZW50cztcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdWbGFuKG9iajogVmxhbil7XHJcbiAgICBjb25zdCBib2R5ID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcclxuICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCcgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KCcvYWRkTmV3VmxhbicsIGJvZHksIHsgaGVhZGVyczogaGVhZGVycyB9KVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdBdGMob2JqOiBBdGMpe1xyXG4gICAgY29uc3QgYm9keSA9IEpTT04uc3RyaW5naWZ5KG9iaik7XHJcbiAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnIH0pO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCgnL2FkZE5ld0F0YycsIGJvZHksIHsgaGVhZGVyczogaGVhZGVycyB9KVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdXTyhvYmo6IEF0Yyl7XHJcbiAgICBjb25zdCBib2R5ID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcclxuICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCcgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KCcvYWRkTmV3V08nLCBib2R5LCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlVmxhbihpZDogbnVtYmVyKXtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZGVsZXRlKCcvZGVsZXRlVmxhbj9pZD0nICsgaWQpXHJcbiAgICAgIC5tYXAoKGRhdGE6IFJlc3BvbnNlICk9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuanNvbigpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUF0YyhpZDogbnVtYmVyKXtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZGVsZXRlKCcvZGVsZXRlQXRjP2lkPScgKyBpZClcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlV08oaWQ6IG51bWJlcil7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmRlbGV0ZSgnL2RlbGV0ZVdPP2lkPScgKyBpZClcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlVmxhbihvYmo6IFZsYW4pe1xyXG4gICAgY29uc3QgYm9keSA9IEpTT04uc3RyaW5naWZ5KG9iaik7XHJcbiAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnIH0pO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHAucHV0KCcvdXBkYXRlVmxhbicsIGJvZHksIHsgaGVhZGVyczogaGVhZGVycyB9KVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdGMob2JqOiBBdGMpe1xyXG4gICAgY29uc3QgYm9keSA9IEpTT04uc3RyaW5naWZ5KG9iaik7XHJcbiAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnIH0pO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHAucHV0KCcvdXBkYXRlQXRjJywgYm9keSwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXHJcbiAgICAgIC5tYXAoKGRhdGE6IFJlc3BvbnNlICk9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuanNvbigpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVdPKG9iajogQXRjKXtcclxuICAgIGNvbnN0IGJvZHkgPSBKU09OLnN0cmluZ2lmeShvYmopO1xyXG4gICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycyh7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04JyB9KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnB1dCgnL3VwZGF0ZVdPJywgYm9keSwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXHJcbiAgICAgIC5tYXAoKGRhdGE6IFJlc3BvbnNlICk9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuanNvbigpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHNhdmVSZXBvcnQoZGF0YSl7XHJcbiAgICBjb25zdCBib2R5ID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbiAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnIH0pO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCgnL3NhdmVSZXBvcnQnLCBib2R5LCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2F2ZU5ld1Byb2JsZW0oZGF0YSl7XHJcbiAgICBjb25zdCBib2R5ID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbiAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnIH0pO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCgnL3NhdmVOZXdQcm9ibGVtJywgYm9keSwgeyBoZWFkZXJzOiBoZWFkZXJzIH0pXHJcbiAgICAgIC5tYXAoKGRhdGE6IFJlc3BvbnNlICk9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuanNvbigpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGZpbHRlclJlcG9ydFJvd3MoZGF0YTogRmlsdGVyKXtcclxuICAgIGNvbnN0IGJvZHkgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxuICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCcgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KCcvZmlsdGVyUmVwb3J0Um93cycsIGJvZHksIHsgaGVhZGVyczogaGVhZGVycyB9KVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBzYXZlVXNlclByaXZpbGVnZXModXNlcjogUHJpdmlsZWdlKXtcclxuICAgIGNvbnN0IGJvZHkgPSBKU09OLnN0cmluZ2lmeSh1c2VyKTtcclxuICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCcgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wdXQoJy9zYXZlVXNlclByaXZpbGVnZXMnLCBib2R5LCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc29sdmluZ1Byb2JsZW0oZGF0YSl7XHJcbiAgICBjb25zdCBib2R5ID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbiAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnIH0pO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHAucHV0KCcvc2F2ZVNvbHZlZFByb2JsZW0nLCBib2R5LCB7IGhlYWRlcnM6IGhlYWRlcnMgfSlcclxuICAgICAgLm1hcCgoZGF0YTogUmVzcG9uc2UgKT0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YS5qc29uKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2VhcmNoRGF0YShxdWVyeTogc3RyaW5nKXtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KCcvc2VhcmNoRGF0YT9xdWVyeT0nICsgcXVlcnkpXHJcbiAgICAgIC5tYXAoKGRhdGE6IFJlc3BvbnNlICk9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuanNvbigpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFJlc3VsdFNlYXJjaChpZDogbnVtYmVyKXtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KCcvZ2V0UmVzdWx0U2VhcmNoP2lkPScgKyBpZC50b1N0cmluZygpKVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VQYXNzd29yZChwYXNzd29yZDogQ2hhbmdlUGFzc3dvcmQpe1xyXG4gICAgY29uc3QgYm9keSA9IEpTT04uc3RyaW5naWZ5KHBhc3N3b3JkKTtcclxuICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCcgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wdXQoJy9jaGFuZ2VQYXNzd29yZCcsIGJvZHksIHsgaGVhZGVyczogaGVhZGVycyB9KVxyXG4gICAgICAubWFwKChkYXRhOiBSZXNwb25zZSApPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmpzb24oKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXREYXRlKGRhdGUpe1xyXG4gICAgbGV0IGRheSAgPSBkYXRlLmdldERhdGUoKSxcclxuICAgICAgbW9udGggID0gZGF0ZS5nZXRNb250aCgpICsgMSxcclxuICAgICAgeWVhciAgID0gZGF0ZS5nZXRGdWxsWWVhcigpLFxyXG4gICAgICBob3VyICAgPSBkYXRlLmdldEhvdXJzKCksXHJcbiAgICAgIG1pbnV0ZSA9IGRhdGUuZ2V0TWludXRlcygpO1xyXG4gICAgICAvLyBzZWNvbmQgPSBkYXRlLmdldFNlY29uZHMoKTtcclxuXHJcbiAgICBpZiAobW9udGggPCAxMCkgeyBtb250aCA9ICcwJyArIG1vbnRoOyB9XHJcbiAgICBpZiAoZGF5IDwgMTApICAgeyBkYXkgPSAnMCcgKyBkYXk7IH1cclxuICAgIGlmIChob3VyIDwgMTApICB7IGhvdXIgPSAnMCcgKyBob3VyOyB9XHJcbiAgICBpZiAobWludXRlIDwgMTApeyBtaW51dGUgPSAnMCcgKyBtaW51dGU7IH1cclxuICAgIC8vIGlmIChzZWNvbmQgPCAxMCl7IHNlY29uZCA9ICcwJyArIHNlY29uZDsgfVxyXG5cclxuICAgIHJldHVybiB5ZWFyICsgXCItXCIgKyBtb250aCArIFwiLVwiICsgZGF5ICsgXCIgXCIgKyBob3VyICsgXCI6XCIgKyBtaW51dGU7XHJcbiAgfVxyXG59XHJcbiJdfQ==
